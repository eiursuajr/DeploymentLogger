
// Generated by MyGeneration Version # (1.1.5.0)

using System;
using DL_DAL.Client;
using System.Data;

namespace DL_WEB.DAL.Client
{
	public class User : _User
    {
        #region Constructor

        public User()
        {
        }

        #endregion

        #region Instance

        private static User m_oInstance = null;

        public static User Instance
        {
            get
            {
                if (null == m_oInstance)
                {
                    m_oInstance = new User();
                }
                return m_oInstance;
            }
        }

        #endregion

        #region Cached Users

        protected DataTable m_dtUsers = null;

        public DataTable Users
        {
            get
            {
                if (null == m_dtUsers)
                {
                    ReloadCache();
                }

                return m_dtUsers;
            }
        }

        #endregion

        #region Properties

        #region AddressBookEntry

        AddressBook m_AddressBookEntry = null;

        public AddressBook AddressBookEntry
        {
            get
            {
                if (null == m_AddressBookEntry &&
                    RowCount > 0)
                {
                    if (!IsColumnNull(ColumnNames.AddressBookEntryID) && 
                        0 != AddressBookEntryID)
                    {
                        m_AddressBookEntry = new AddressBook();
                        m_AddressBookEntry.ConnectionString = this.ConnectionString;
                        m_AddressBookEntry.LoadByPrimaryKey(AddressBookEntryID);

                    }
                }
                return m_AddressBookEntry;
            }
            set 
            {
                if (null == m_AddressBookEntry || 
                    (null != m_AddressBookEntry &&
                    !m_AddressBookEntry.Equals(value)))
                {
                    m_AddressBookEntry = value;
                }
            }
        }

        #endregion

        #endregion

        #region Private Methods

        protected void ReloadCache()
        {
            this.LoadAll();
            m_dtUsers = this.DefaultView.Table;
        }

        #endregion

        #region Public Methods

        public int GetUserIDByGUID(Guid oUserGUID)
        {
            DataRow[] drsUsers = Users.Select(string.Format("GUID = '{0}'", oUserGUID.ToString()));
            if (drsUsers.Length > 0)
            {
                return Micajah.Common.Helper.Convert.o2i(drsUsers[0]["UserID"]);
            }

            return 0;
        }

        public DataView LoadAllUser()
        {
            base.LoadAll();
            return base.DefaultView;
        }
        
        #endregion
    }
}
